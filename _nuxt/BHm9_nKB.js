import{r as L,k as N,n as R,d as j,y as g,z as u,A as c,F as b,B as v,o as E,e as U,G as W,T,H as I,I as M,J as q,K as x,L as O,M as $,N as z,C as P,_ as V}from"./BuHjgWAY.js";const A=[{id:"1",word:"agenda",definition:"A list of items to be discussed during a meeting."},{id:"2",word:"minutes",definition:"A written record of a meeting's discussions and decisions."},{id:"3",word:"quorum",definition:"The minimum number of members required to conduct business."}];function D(f){const i=[];let s="",t=[],n=!1;for(let o=0;o<f.length;o++){const e=f[o];if(e==='"'){if(n&&f[o+1]==='"'){s+='"',o++;continue}n=!n;continue}if(e===","&&!n){t.push(s),s="";continue}if(e===`
`&&!n){t.push(s),i.push(t),t=[],s="";continue}e!=="\r"&&(s+=e)}(s!==""||t.length)&&(t.push(s),i.push(t));const r=i.map(o=>o.map(e=>e.trim()));if(r.length===0)return[];const m=["tittel","tittel på ord","ordklasse","definisjon","definition","word"];let d=r.findIndex(o=>o.some(e=>{const y=e.toLowerCase();return m.some(w=>y.includes(w))}));d===-1&&(d=0);const p=r[d].map(o=>o.toLowerCase()),l=r.slice(d+1).filter(o=>o.some(e=>e!=="")),a=p.map((o,e)=>({h:o,idx:e})).filter(o=>o.h.includes("definisjon")||o.h.includes("definition")).sort((o,e)=>{const y=(o.h.match(/(\d+)/)||[])[0]||"0",w=(e.h.match(/(\d+)/)||[])[0]||"0";return Number(y)-Number(w)});return l.map(o=>{const e={};for(let h=0;h<p.length;h++)e[p[h]]=(o[h]??"").toString();const y=e.id??e["#"]??o[0]??"",w=e["tittel på ord"]??e.tittel??e.title??e.word??o[0]??"",_=e.ordklasse??e["ordklasse:"]??"",C=e.bøyninger??e.bøyning??e.variants??"",S=e.tilleggsinformasjon??e.tilleggsinfo??e["tilleggsinformasjon:"]??"",k=[];for(const h of a){const B=e[h.h];B&&k.push(B)}return k.length===0&&(e.definition||e.definisjon)&&k.push(e.definition??e.definisjon),{id:y.toString(),word:w.toString(),ordklasse:_.toString(),boyninger:C.toString(),tilleggsinformasjon:S.toString(),definitions:k,definition:k[0]??""}})}function G(){const f=L(A),i=L(""),s=N(()=>{const t=i.value.trim().toLowerCase();return t?f.value.filter(n=>!!(n.word&&n.word.toLowerCase().includes(t)||n.ordklasse&&n.ordklasse.toLowerCase().includes(t)||n.boyninger&&n.boyninger.toLowerCase().includes(t)||n.tilleggsinformasjon&&n.tilleggsinformasjon.toLowerCase().includes(t)||n.definition&&n.definition.toLowerCase().includes(t)||n.definitions&&n.definitions.some(r=>r.toLowerCase().includes(t)))):f.value});try{const n=R().public?.googleSheetCsvUrl;n&&(async()=>{try{const m=(a=>{try{if(!a.includes("docs.google.com/spreadsheets")||a.includes("/export")||a.includes("output=csv"))return a;const o=new URL(a),e=o.pathname.match(/\/d\/([^/]+)/),y=e?e[1]:o.searchParams.get("id");let w=o.searchParams.get("gid");if(!w&&o.hash){const C=o.hash.replace(/^#/,"");w=new URLSearchParams(C).get("gid")}if(!y)return a;let _=`https://docs.google.com/spreadsheets/d/${y}/export?format=csv`;return w&&(_+=`&gid=${encodeURIComponent(w)}`),_}catch{return a}})(String(n)),d=await fetch(m);if(!d.ok)throw new Error(`fetch failed: ${d.status}`);const p=await d.text(),l=D(p);l.length&&(f.value=l)}catch(r){console.warn("useWords: failed to fetch remote sheet",r)}})()}catch{}return{items:f,query:i,results:s}}const K={style:{display:"flex","justify-content":"space-between","align-items":"center"}},Y={class:"word"},F={key:0,class:"small"},H=j({__name:"WordItem",props:{word:{}},setup(f){return(i,s)=>(u(),g("div",{class:"item",onClick:s[0]||(s[0]=t=>i.$emit("open",i.word))},[c("div",K,[c("div",null,[c("div",Y,v(i.word.word),1),i.word.ordklasse?(u(),g("div",F,v(i.word.ordklasse),1)):b("",!0)]),s[1]||(s[1]=c("div",{class:"small",style:{opacity:"0.6"}},"Details",-1))])]))}}),J=Object.assign(H,{__name:"WordItem"}),Q={class:"modal-card",role:"dialog","aria-modal":"true"},X={style:{display:"flex","justify-content":"space-between","align-items":"flex-start"}},Z={class:"word"},ee={key:0,class:"small"},oe={key:0,class:"meta",style:{"margin-top":"12px"}},te={style:{"margin-top":"12px"}},ne=j({__name:"WordModal",props:{word:{}},setup(f){let i=null,s=null,t=null,n=null,r=0;function m(){r=window.scrollY||window.pageYOffset||0,i=document.body.style.overflow,s=document.body.style.position,t=document.body.style.top,n=document.body.style.width,document.body.style.overflow="hidden",document.body.style.position="fixed",document.body.style.top=`-${r}px`,document.body.style.width="100%"}function d(){document.body.style.overflow=i??"",document.body.style.position=s??"",document.body.style.top=t??"",document.body.style.width=n??"",window.scrollTo(0,r)}const p=l=>{l.key==="Escape"&&window.dispatchEvent(new CustomEvent("close-word-modal"))};return E(()=>{window.addEventListener("keydown",p),m()}),U(()=>{window.removeEventListener("keydown",p),d()}),(l,a)=>(u(),W(T,{to:"body"},[c("div",{class:"modal-backdrop",onClick:a[1]||(a[1]=q(o=>l.$emit("close"),["self"]))},[c("div",Q,[c("div",X,[c("div",null,[c("div",Z,v(l.word.word),1),l.word.ordklasse?(u(),g("div",ee,v(l.word.ordklasse),1)):b("",!0)]),c("button",{onClick:a[0]||(a[0]=o=>l.$emit("close"))},"Close")]),l.word.tilleggsinformasjon?(u(),g("div",oe,v(l.word.tilleggsinformasjon),1)):b("",!0),c("div",te,[(u(!0),g(I,null,M(l.word.definitions||[l.word.definition],(o,e)=>(u(),g("div",{key:e,style:{"margin-top":"8px"}},v(o),1))),128))])])])]))}}),se=Object.assign(ne,{__name:"WordModal"}),ie={class:"search"},re={class:"list"},de={key:0,class:"divider"},le=j({__name:"index",setup(f){const{results:i,query:s}=G(),t=L(null);function n(r){t.value=r}return E(()=>{window.addEventListener("close-word-modal",()=>{t.value=null})}),U(()=>{window.removeEventListener("close-word-modal",()=>{t.value=null})}),(r,m)=>(u(),g("div",null,[c("div",ie,[x(c("input",{class:"input",style:{color:"azure"},"onUpdate:modelValue":m[0]||(m[0]=d=>z(s)?s.value=d:null),placeholder:"Search words or definitions"},null,512),[[O,$(s)]])]),c("div",re,[(u(!0),g(I,null,M($(i),(d,p)=>(u(),g("div",{key:d.id},[P(J,{word:d,onOpen:n},null,8,["word"]),p<$(i).length-1?(u(),g("div",de)):b("",!0)]))),128))]),t.value?(u(),W(se,{key:0,word:t.value,onClose:m[1]||(m[1]=d=>t.value=null)},null,8,["word"])):b("",!0)]))}}),ce=V(le,[["__scopeId","data-v-8a2d0fe3"]]);export{ce as default};
